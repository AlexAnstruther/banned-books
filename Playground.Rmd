---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.15.2
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---

```{python}
import sqlite3
import pandas as pd
import math
import numpy as np
conn = sqlite3.connect('CompasAnalysis/compas.db')
tables_query = "SELECT name FROM sqlite_master WHERE type='table';"
tables = pd.read_sql_query(tables_query, conn)
dfs = []
for table in tables['name']:
    exec(f'{table} = pd.read_sql_query(f"SELECT * FROM {table}", conn)')
    dfs.append(f'{table}')
conn.close()
```

```{python}
dfs
```

```{python}
casearrest.head()
```

```{python}
prisonhistory.head()
```

```{python}
jailhistory.head()
```

```{python}
compas.head()
```

```{python}
summary.head()
```

```{python}
charge.head()
```

```{python}
people.head()
```

```{python}
assert len(compas['person_id'].unique()) == 11757
assert len(people) == 11757
```

```{python}
people['time_out'] = pd.to_datetime(people['r_jail_in']) - pd.to_datetime(people['c_jail_out'])
```

```{python}
pd.to_datetime(people['r_jail_out']) - pd.to_datetime(people['c_jail_out'])
```

```{python}
people['time_out'] = people['time_out'].apply(lambda x : pd.to_datetime(people['r_jail_out']) - pd.to_datetime(people['c_jail_out']) if x == np.nan else x)
```

```{python}
people['time_out'].mean()
```

```{python}

```
